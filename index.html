                } else if (checkCollision({
                    x: bullet.x + bullet.width / 2,
                    y: bullet.y + bullet.height / 2,
                    radius: bullet.width / 2
                }, {
                    x: ship.x + ship.width / 2,
                    y: ship.y + ship.height / 2,
                    radius: ship.width / 2
                })) {
                    ship.alive = false;
                }
            });

            if (!ship.alive) {
                clearInterval(scoreInterval);
                clearInterval(bossUfoShootingInterval); // Lopeta ampuminen
                clearInterval(obstacleInterval);
                clearInterval(followUfoInterval);
                clearInterval(splitUfoInterval);
                clearInterval(ammoUpgradeInterval);
            }
        }

        function draw() {
            ctx.drawImage(images.background, 0, 0, canvas.width, canvas.height);
            ctx.drawImage(images.ship, ship.x, ship.y, ship.width, ship.height);

            bullets.forEach(bullet => {
                ctx.drawImage(images.bullet, bullet.x, bullet.y, bullet.width, bullet.height);
            });

            obstacles.forEach(ob => {
                if (ob.hits > 0) {
                    ctx.drawImage(images.basicUfo, ob.x, ob.y, ob.width, ob.height);
                }
            });

            if (followUfo && followUfo.hits > 0) {
                ctx.drawImage(images.followUfo, followUfo.x, followUfo.y, followUfo.width, followUfo.height);
            }

            splitUfos.forEach(splitUfo => {
                if (splitUfo.hits > 0) {
                    ctx.drawImage(images.splitUfo, splitUfo.x, splitUfo.y, splitUfo.width, splitUfo.height);
                }
            });

            if (ammoUpgrade) {
                ctx.drawImage(images.ammoUpgrade, ammoUpgrade.x, ammoUpgrade.y, ammoUpgrade.width, ammoUpgrade.height);
            }

            if (bossUfo && bossUfo.hits > 0) {
                ctx.drawImage(images.bossUfo, bossUfo.x, bossUfo.y, bossUfo.width, bossUfo.height);
            }

            // Piirretään bossUfon ammukset
            bossBullets.forEach(bullet => {
                ctx.drawImage(images.bossShot, bullet.x, bullet.y, bullet.width, bullet.height);
            });
        }

        function gameLoop() {
            if (ship.alive) {
                update();
                draw();
                requestAnimationFrame(gameLoop);
            } else {
                clearInterval(scoreInterval);
                clearInterval(bossUfoShootingInterval); // Lopeta ampuminen
                clearInterval(obstacleInterval);
                clearInterval(followUfoInterval);
                clearInterval(splitUfoInterval);
                clearInterval(ammoUpgradeInterval);
                ctx.fillStyle = "white";
                ctx.font = "30px Arial";
                ctx.fillText("Game Over", canvas.width / 2 - 80, canvas.height / 2);
                ctx.fillText("Pisteet: " + score, canvas.width / 2 - 80, canvas.height / 2 + 30);

                // Lisätään uudelleenkäynnistysnappula
                const existingButton = document.getElementById("restartButton");
                if (existingButton) {
                    document.body.removeChild(existingButton);
                }
                const restartButton = document.createElement("button");
                restartButton.textContent = "Uudelleen";
                restartButton.id = "restartButton";
                document.body.appendChild(restartButton);
                restartButton.addEventListener("click", () => {
                    document.body.removeChild(restartButton);
                    init();
                    gameLoop();
                });
            }
        }

        // Alustetaan peli ja käynnistetään pelisilmukka
        init();
        gameLoop();
    </script>
</body>
</html>
